Homework 5
================
2022-11-03

## Problem 2

``` r
homicide_df = read.csv("./data/homicide-data.csv")
```

The raw data contains 52179 observations and 12 variables. The key
variables are uid, reported date, victim last name, victim first name,
victim race, victim age, victim sex, city, state, latitude, longitude,
and disposition. The dataset contains information from 28 distinct
states.

``` r
homicide_df = homicide_df %>% mutate(city_state = paste(city, state, sep = ", "))

homicide_summary = homicide_df %>% group_by(city_state) %>% summarize(total_homicide = n(), unsolved_homicides = sum(disposition == "Closed without arrest" | disposition == "Open/No arrest"))

head(homicide_summary, 5) %>% knitr::kable()
```

| city_state      | total_homicide | unsolved_homicides |
|:----------------|---------------:|-------------------:|
| Albuquerque, NM |            378 |                146 |
| Atlanta, GA     |            973 |                373 |
| Baltimore, MD   |           2827 |               1825 |
| Baton Rouge, LA |            424 |                196 |
| Birmingham, AL  |            800 |                347 |

``` r
baltimoreptest = prop.test(homicide_summary %>% filter(city_state == "Baltimore, MD") %>% pull(unsolved_homicides), homicide_summary %>% filter(city_state == "Baltimore, MD") %>% pull(total_homicide))

baltimoreptest = baltimoreptest %>% broom::tidy()
```

The estimated proportion is approximately 0.65 and the 95% confidence
interval is (0.63, 0.66).

``` r
homicide_sum = homicide_summary %>% mutate(
    prop_test = map2(
        homicide_summary$unsolved_homicides,
        homicide_summary$total_homicide, prop.test), 
    results = map(prop_test, broom::tidy)
    )
```

    ## Warning in .f(.x[[i]], .y[[i]], ...): Chi-squared approximation may be incorrect

``` r
homicide_sum = homicide_sum %>% unnest(results) %>% select(-c(prop_test, parameter, method, alternative))
```

## Problem 3

``` r
sim = function(n, mu = 0, sigma = 5) {
  
  sim_data = tibble(
    x = rnorm(n = n, mean = mu, sd = sigma),
  )
}

mu_0_df = 
  expand_grid(
    sample_size = 30,
    iter = 1:5000
  ) %>% 
  mutate(
    estimate_df = map(sample_size, sim)
  ) %>% group_by(iter) %>%
  mutate(
    mean = map_dbl(.x = estimate_df, ~mean(.x$x)),
    t_test = map(.x = estimate_df, ~t.test(.x$x)),
    results = map(t_test, broom::tidy)
    ) 

mu_0_df = mu_0_df %>% unnest(results) %>% dplyr::select(-c("estimate_df", "t_test", "parameter", "method", "alternative"))
```
